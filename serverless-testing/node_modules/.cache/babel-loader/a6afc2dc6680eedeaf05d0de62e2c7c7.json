{"ast":null,"code":"import \"source-map-support/register\";\n\nconst mysql = require(\"mysql\");\n\nvar pool = mysql.createPool({\n  host: \"logan-poc-serverless-db.cluster-ctb7pckp3icd.ap-southeast-1.rds.amazonaws.com\",\n  user: \"admin\",\n  password: \"admin1234\",\n  database: \"Cinema\"\n});\n\nconst apiResponse = (status, msg) => {\n  return {\n    statusCode: status,\n    body: JSON.stringify({\n      message: msg\n    })\n  };\n};\n\nexport const hello = async (event, context, callback) => {\n  pool.getConnection(function (error, connection) {\n    return apiResponse(500, error);\n    console.log(error, connection);\n    if (error) return callback(error);\n    connection.query(`SELECT * FROM Movie`, function (error, results, fields) {\n      if (error) {\n        connection.destroy(); // context.done(null, event);\n\n        return apiResponse(500, error);\n      } else {\n        console.log(results);\n        callback(error, event);\n        connection.end(function (err) {\n          callback(err, results);\n        }); // context.done(null, event);\n\n        return apiResponse(200, results);\n      }\n    });\n  });\n};","map":{"version":3,"sources":["/Users/logan/Documents/GitHub/serverless-testing/notes-api/tests/handler.js"],"names":["mysql","require","pool","createPool","host","user","password","database","apiResponse","status","msg","statusCode","body","JSON","stringify","message","hello","event","context","callback","getConnection","error","connection","console","log","query","results","fields","destroy","end","err"],"mappings":";;AAAA,MAAMA,KAAK,GAAGC,OAAO,CAAC,OAAD,CAArB;;AAEA,IAAIC,IAAI,GAAGF,KAAK,CAACG,UAAN,CAAiB;AAC1BC,EAAAA,IAAI,EAAE,+EADoB;AAE1BC,EAAAA,IAAI,EAAE,OAFoB;AAG1BC,EAAAA,QAAQ,EAAE,WAHgB;AAI1BC,EAAAA,QAAQ,EAAE;AAJgB,CAAjB,CAAX;;AAOA,MAAMC,WAAW,GAAG,CAACC,MAAD,EAASC,GAAT,KAAiB;AACnC,SAAO;AACLC,IAAAA,UAAU,EAAEF,MADP;AAELG,IAAAA,IAAI,EAAEC,IAAI,CAACC,SAAL,CAAe;AACnBC,MAAAA,OAAO,EAAEL;AADU,KAAf;AAFD,GAAP;AAMD,CAPD;;AASA,OAAO,MAAMM,KAAK,GAAG,OAAOC,KAAP,EAAcC,OAAd,EAAuBC,QAAvB,KAAoC;AAEvDjB,EAAAA,IAAI,CAACkB,aAAL,CAAmB,UAAUC,KAAV,EAAiBC,UAAjB,EAA6B;AAChD,WAAOd,WAAW,CAAC,GAAD,EAAMa,KAAN,CAAlB;AAEAE,IAAAA,OAAO,CAACC,GAAR,CAAYH,KAAZ,EAAmBC,UAAnB;AACE,QAAID,KAAJ,EAAW,OAAOF,QAAQ,CAACE,KAAD,CAAf;AACXC,IAAAA,UAAU,CAACG,KAAX,CAAkB,qBAAlB,EAAwC,UAAUJ,KAAV,EAAiBK,OAAjB,EAA0BC,MAA1B,EAAkC;AACxE,UAAIN,KAAJ,EAAW;AACTC,QAAAA,UAAU,CAACM,OAAX,GADS,CAET;;AACA,eAAOpB,WAAW,CAAC,GAAD,EAAMa,KAAN,CAAlB;AAED,OALD,MAKO;AACLE,QAAAA,OAAO,CAACC,GAAR,CAAYE,OAAZ;AACAP,QAAAA,QAAQ,CAACE,KAAD,EAAQJ,KAAR,CAAR;AACAK,QAAAA,UAAU,CAACO,GAAX,CAAe,UAAUC,GAAV,EAAe;AAC5BX,UAAAA,QAAQ,CAACW,GAAD,EAAMJ,OAAN,CAAR;AACD,SAFD,EAHK,CAML;;AACA,eAAOlB,WAAW,CAAC,GAAD,EAAMkB,OAAN,CAAlB;AACD;AACF,KAfD;AAgBD,GArBD;AAsBD,CAxBM","sourcesContent":["const mysql = require(\"mysql\");\n\nvar pool = mysql.createPool({\n  host: \"logan-poc-serverless-db.cluster-ctb7pckp3icd.ap-southeast-1.rds.amazonaws.com\",\n  user: \"admin\",\n  password: \"admin1234\",\n  database: \"Cinema\",\n});\n\nconst apiResponse = (status, msg) => {\n  return {\n    statusCode: status,\n    body: JSON.stringify({\n      message: msg,\n    }),\n  };\n};\n\nexport const hello = async (event, context, callback) => {\n\n  pool.getConnection(function (error, connection) {\n  return apiResponse(500, error);\n\n  console.log(error, connection);\n    if (error) return callback(error);\n    connection.query(`SELECT * FROM Movie`, function (error, results, fields) {\n      if (error) {\n        connection.destroy();\n        // context.done(null, event);\n        return apiResponse(500, error);\n\n      } else {\n        console.log(results);\n        callback(error, event);\n        connection.end(function (err) {\n          callback(err, results);\n        });\n        // context.done(null, event);\n        return apiResponse(200, results);\n      }\n    });\n  });\n};\n"]},"metadata":{},"sourceType":"module"}